/*---------------------------------------------------------------------------*\
 * (c) 2008 Realtek Semiconductor Corporation (http://www.realtek.com/)      *
 * All rights reserved.                                                      *
\*---------------------------------------------------------------------------*/

/*****************************************************************************\
 * @file     ttx_test.c
 * @brief    TTX library self test interface.
 * @details  This header declares the public access application interface for this TtLib library.
 * @author   Janus Cheng
 * @date     Dec. 11, 2008
 * @version  0.1
 * @ingroup  ttx
\*****************************************************************************/

#include <stdlib.h> /* Provides: NULL */
#include <string.h> /* Provides: memcpy() */

#include <ttx.h>            /* Provides: functions to be implemented */
#include <ttx_source.h>     /* Provides: TTX_SRC_Test() */
#include <ttx_buff.h>       /* Provides: TTX_BUF_Test() */
#include <ttx_disp.h>       /* Provides: TTX_DISP_Test() */

# if 0
#include <ppr.h>    /* Provides: Pre-Processor module */
#include <vte.h>    /* Provides: VBI Transfer Engine module */
#include <osd.h>    /* Provides: OSD_Test() */
#include <vd.h>     /* Provides: Video Decoder module */
#include <sys.h>    /* Provides: System module */
#endif

#include <ttx_assert.h> /* Provides: TTX_DEFINE_THIS_MODULE() */



TTX_DEFINE_THIS_MODULE( ttx_test.c )


/* -- Prototypes of Private Functions ---------------------------------------*/


/*---------------------------------------------------------------------------*/
bool_t
TTX_Test        (TTX_Handle hTtx)
/*****************************************************************************\
 *  @brief   The assertion-failure handler callback.
 *  @pre     TTX_Init() has been successfully run.
 *  @note    Must be called in advance of any other functions.
 *
 *  @ingroup ttx
 *  @see     TTApi_DeInit()
\*****************************************************************************/
{
#if TTX_VERIFY  /* if enabled verficiation of TTX related IPs */

    bool_t bDispOk,
    bBuffOk,
    bSrcOk;

    if ( hTtx != NULL )
    {
    }

    bDispOk = TTX_DISP_Test();
    bBuffOk = TTX_BUF_Test();
    bSrcOk  = TTX_SRC_Test();

    return( bDispOk && bBuffOk && bSrcOk );
#else

    if ( hTtx != NULL )
    {
    }

    return( FALSE );    /* test failure */
#endif  /* end of #if TTX_VERIFY */
}

#if 0
/*---------------------------------------------------------------------------*/
void
TTX_TestDecodePage0        (TTX_Handle hTtx)
/*****************************************************************************\
 *  @brief   Test TTX_DecodePage() and OSD.
 *  @pre     OSD_Open() has been run in advance.
 *  @see     TTApi_DeInit()
\*****************************************************************************/
{
    void TTX_MEM*         pPageBuf = (void TTX_MEM*)(0x8430);
    OSD_TtAttr_t TTX_MEM* pAttrMem;

    // Note: Calling OSD_GetTtAttr1Address() must be after OSD_Open().
    //         Because attributes address is updated in OSD_Open().
    pAttrMem = (OSD_TtAttr_t TTX_MEM*)OSD_GetTtAttr1Address();

    // Prepare source: pPageBuf
    {
        // These are undescrambled X/0 to X/23 (in order) of  P100.2 of 7_Melb_151106.ts
        uint8_t const TTX_ROM TTX_test7_Melb_151106_P100_2_pkts [24][40] =
        {
            { 0x15, 0x15, 0x49, 0x15, 0x15, 0x15, 0x38, 0x15, 0x01, 0xC1, 0x75, 0x73, 0xF4, 0xE5, 0xF8, 0xF4, 0x02, 0x31, 0xB0, 0xB0, 0x07, 0x57, 0xE5, 0x64, 0x20, 0x31, 0xB5, 0x20, 0xCE, 0xEF, 0x76, 0x83, 0xB0, 0xB9, 0xBA, 0xB5, 0xB5, 0xBA, 0xB3, 0xB5 }, \
            { 0x97, 0x9D, 0x01, 0x0D, 0xC1, 0x20, 0xD5, 0x20, 0xD3, 0x20, 0x54, 0x20, 0x45, 0x20, 0x58, 0x20, 0x54, 0x20, 0x20, 0x20, 0xCD, 0x20, 0xC1, 0x20, 0x49, 0x20, 0xCE, 0x20, 0x20, 0x20, 0x49, 0x20, 0xCE, 0x20, 0xC4, 0x20, 0x45, 0x20, 0x58, 0x20 }, \
            { 0x16, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x97, 0x9D, 0x04, 0x20, 0x20, 0x20, 0x43, 0x4F, 0xD0, 0xD9, 0x52, 0x49, 0xC7, 0xC8, 0x54, 0x20, 0x49, 0xCE, 0x46, 0x4F, 0x52, 0xCD, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0x20, 0x4F, 0xCE, 0x20, 0x31, 0xB0, 0x34, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x91, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C, 0x2C }, \
            { 0x04, 0x9D, 0x20, 0x83, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x49, 0xCE, 0x46, 0x4F, 0x52, 0xCD, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x94, 0x9D, 0x86, 0xCD, 0xC1, 0x49, 0xCE, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0xAE, 0xAE, 0xAE, 0x31, 0xB0, 0xB0, 0x13, 0x9D, 0x01, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0x31, 0xB9 }, \
            { 0x04, 0x9D, 0x86, 0xC2, 0xD5, 0xD3, 0x49, 0xCE, 0x45, 0xD3, 0xD3, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0x31, 0x31, 0x13, 0x9D, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x83, 0x9D, 0x04, 0xCE, 0x45, 0x57, 0xD3, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0x31, 0xB9, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0xCE, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0xC1, 0x4C, 0x20, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x20, 0x20 }, \
            { 0x04, 0x9D, 0x86, 0xD3, 0xD0, 0x4F, 0x52, 0x54, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0xB6, 0xB0, 0x13, 0x9D, 0x04, 0x04, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0x32, 0xB0 }, \
            { 0x04, 0x9D, 0x86, 0x04, 0x49, 0xCE, 0xC1, 0xCE, 0x43, 0x45, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x32, 0xB0, 0xB0, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0xC4, 0x45, 0x54, 0xC1, 0x49, 0x4C, 0xD3, 0x20, 0x31, 0x32, 0x31, 0x20, 0x5D, 0x31, 0xB3, 0xB0 }, \
            { 0x94, 0x9D, 0x86, 0x57, 0x45, 0xC1, 0x54, 0xC8, 0x45, 0x52, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xB3, 0xB0, 0xB0, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0xCE, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0xC1, 0x4C, 0x20, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x20, 0x20 }, \
            { 0x94, 0x9D, 0x86, 0x54, 0xC1, 0xC2, 0x20, 0xD3, 0x45, 0x52, 0xD6, 0x49, 0x43, 0x45, 0xAE, 0xAE, 0xB5, 0xB0, 0xB0, 0x13, 0x9D, 0x04, 0x20, 0x20, 0x52, 0x45, 0xD6, 0x49, 0x45, 0x57, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x31, 0xB3, 0x37 }, \
            { 0x94, 0x9D, 0x86, 0xC7, 0x45, 0xCE, 0x45, 0x52, 0xC1, 0x4C, 0x20, 0x49, 0xCE, 0x46, 0x4F, 0xAE, 0xB6, 0xB0, 0xB0, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0x49, 0xCE, 0x54, 0x45, 0x52, 0xCE, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0xC1, 0x4C, 0x20, 0x20, 0x20 }, \
            { 0x94, 0x9D, 0x86, 0x54, 0xD6, 0x20, 0xD0, 0x52, 0x4F, 0xC7, 0x52, 0xC1, 0xCD, 0xD3, 0xAE, 0xAE, 0xB6, 0xB5, 0xB0, 0x13, 0x9D, 0x04, 0x20, 0x20, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x52, 0x45, 0xD6, 0x49, 0x45, 0x57, 0xAE, 0xAE, 0x31, 0xB3, 0x38 }, \
            { 0x04, 0x9D, 0x86, 0x43, 0xC1, 0xD0, 0x54, 0x49, 0x4F, 0xCE, 0xD3, 0xAE, 0xAE, 0xAE, 0xAE, 0xAE, 0x38, 0xB0, 0x31, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x4C, 0xC1, 0x54, 0x45, 0xD3, 0x54, 0xAE, 0xAE, 0x31, 0xB3, 0xB9 }, \
            { 0x94, 0x9D, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0x49, 0xCE, 0x54, 0x45, 0x52, 0xCE, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0xC1, 0x4C, 0x20, 0x20, 0x20 }, \
            { 0x94, 0x9D, 0x86, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x13, 0x9D, 0x04, 0x20, 0x04, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0xAE, 0xAE, 0xAE, 0x31, 0x34, 0xB0 }, \
            { 0x94, 0x9D, 0x86, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x13, 0x9D, 0x01, 0x2A, 0x04, 0xC4, 0x45, 0x54, 0xC1, 0x49, 0x4C, 0xD3, 0x20, 0x31, 0x34, 0x31, 0x20, 0x5D, 0x31, 0xB5, 0xB0 }, \
            { 0x94, 0x9D, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x13, 0x9D, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x94, 0x9D, 0x86, 0x20, 0x20, 0x04, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x07, 0x9D, 0x20, 0x20, 0x01, 0xCD, 0xC1, 0xCB, 0x45, 0x20, 0xC1, 0xD5, 0xD3, 0x54, 0x45, 0x58, 0x54, 0x20, 0xD9, 0x4F, 0xD5, 0x52, 0x20, 0x46, 0x49, 0x52, 0xD3, 0x54, 0x20, 0x43, 0xC8, 0x4F, 0x49, 0x43, 0x45, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x07, 0x9D, 0x01, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x46, 0x4F, 0x52, 0x20, 0x4C, 0x4F, 0x43, 0xC1, 0x4C, 0x20, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }, \
            { 0x01, 0x9D, 0x07, 0x20, 0x20, 0x20, 0xCE, 0xC1, 0x54, 0x49, 0x4F, 0xCE, 0xC1, 0x4C, 0x20, 0xCE, 0x45, 0x57, 0xD3, 0x20, 0x49, 0xCE, 0xC4, 0x45, 0x58, 0x20, 0xD0, 0xC1, 0xC7, 0x45, 0x20, 0x31, 0x32, 0xB0, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20 }  \
        };
        memcpy( pPageBuf, TTX_test7_Melb_151106_P100_2_pkts, 24*40 );
    }

    // Decode Page: page buffer -> OSD attr -> OSD
    TTX_DecodePage( pAttrMem, pPageBuf, 0, 25 );
}
#endif

/*---------------------------------------------------------------------------*\
 * end of ttx_test.c                                                         *
\*---------------------------------------------------------------------------*/
